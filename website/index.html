<!DOCTYPE HTML>
<!--
	Industrious by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>

<head>
	<title>Industrious by TEMPLATED</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<link rel="stylesheet" href="assets/css/main.css" />
</head>

<body class="is-preload">

	<!-- Header -->
	<header id="header">
		<a class="logo" href="index.html">Who's There</a>

	</header>


	<!-- Banner -->
	<section id="banner">
		<div class="inner">
			<h1>Who's There</h1>
			<p>Protecting your home and love ones with.<br />Using Computer Vision and Machine Learning.</p>
		</div>
		<video autoplay loop muted playsinline src="images/banner.mp4"></video>
	</section>

	<!-- Highlights -->
	<section class="wrapper">
		<div class="inner">
			<header class="special">
				<h2>How it works.</h2>
				<p>Using computer vision and machine learning who's there determines wether the man at your front door is your son
					or a burgler, and it notifies you via sms about it.</p>
			</header>

			<div>
				<table cellpadding="0" cellspacing="0" width="0" border="0">
				<tbody><tr>
					<td>
						<video id="videoInput" width="320" height="240"></video>
					</td>
					<td>
						<canvas id="canvasOutput" width="320" height="240"></canvas>
					</td>
					<td></td>
					<td></td>
				</tr>
				<tr>
					<td>
						<div class="caption">videoInput</div>
					</td>
					<td>
						<div class="caption">canvasOutput</div>
					</td>
					<td></td>
					<td></td>
				</tr>
				</tbody></table>
			</div>
		</div>
	</section>



	<!-- Footer -->
	<footer id="footer">
		<div class="inner">
			<div class="content">
				<section>
					<h3>Why it's receassary</h3>
					<p>There are 1,495,790 burglaries during the day. Break ins are 6% more likely to occur during the day between 6am
						and 6pm while people are at work or running errands.</p>
				</section>
			</div>
			<div class="copyright">
				<p>
					Made with <i class="fa fa-heart"></i> @ HackUTA
				</p>
			</div>
			
		</div>
	</footer>

	<!-- Scripts -->
	
	<script type="text/javascript" src="https://sdk.clarifai.com/js/clarifai-latest.js"></script>
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

	<script type="text/javascript">

function onOpenCvReady(){
let video = document.getElementById('videoInput');
let src = new cv.Mat(video.height, video.width, cv.CV_8UC4);
let dst = new cv.Mat(video.height, video.width, cv.CV_8UC4);
let gray = new cv.Mat();
let cap = new cv.VideoCapture(video);
let faces = new cv.RectVector();
let classifier = new cv.CascadeClassifier();

// load pre-trained classifiers
classifier.load('haarcascade_frontalface_alt.xml');

const FPS = 30;
function processVideo() {
    try {
        if (!streaming) {
            // clean and stop.
            src.delete();
            dst.delete();
            gray.delete();
            faces.delete();
            classifier.delete();
            return;
        }
        let begin = Date.now();
        // start processing.
        cap.read(src);
        src.copyTo(dst);
        cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0);
        // detect faces.
        classifier.detectMultiScale(gray, faces, 1.1, 3, 0);
        // draw faces.
        for (let i = 0; i < faces.size(); ++i) {
            let face = faces.get(i);
            let point1 = new cv.Point(face.x, face.y);
            let point2 = new cv.Point(face.x + face.width, face.y + face.height);
            cv.rectangle(dst, point1, point2, [255, 0, 0, 255]);
        }
        cv.imshow('canvasOutput', dst);
        // schedule the next one.
        let delay = 1000/FPS - (Date.now() - begin);
        setTimeout(processVideo, delay);
    } catch (err) {
        //utils.printError(err);
    }
};

// schedule the first one.
setTimeout(processVideo, 0);
}



	</script>


<script async type="text/javascript"  onload="onOpenCvReady();" src="opencv.js"></script>

</body>

</html>